---
# tasks file for mablanco.antirootkits

- name: Antirootkits | antirootkits_mail_from variable should be defined
  assert:
    that:
    - antirootkits_mail_from is defined and antirootkits_mail_from | length > 0
    msg: "Set the value of 'antirootkits_mail_from' in either the inventory file or the playbook invoking this role."

- name: Antirootkits | antirootkits_mail_to variable should be defined
  assert:
    that:
    - antirootkits_mail_to is defined and antirootkits_mail_to | length > 0
    msg: "Set the value of 'antirootkits_mail_to' in either the inventory file or the playbook invoking this role."

- name: Antirootkits | load OS Family specific defaults
  include_vars: "{{ ansible_os_family|lower }}.yml"

- name: Antirootkits | Rkhunter
  include: rkhunter.yml
  when: rkhunter
  tags: [ 'rkhunter' ]

- name: Antirootkits | chkrootkit
  include: chkrootkit.yml
  when:
    - chkrootkit
    - ansible_os_family == "Debian"
  tags: [ 'chkrootkit' ]

- name: Antirootkits | Unhide
  include: unhide.yml
  when:
    - unhide
    - ansible_os_family == "Debian"
  tags: [ 'unhide' ]

- name: Antirootkits | Shell Detector
  include: shelldetector.yml
  when: shelldetector
  tags: [ 'shelldetector' ]
